---
title: "ElectionForecast2020"
author: "Brian Diep"
date: "25/10/2020"
output: pdf_document
---

```{r setup, include=FALSE}

#Import libraries
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(broom)
library(here)
library(skimr)
library(usmap)
library(ggplot2)
```
## Keywords
BIDEN, TRUMP, 2020 US ELECTION, FORECASTING, MULTILEVEL REGRESSION WITH POSTSTRATIFICATION

## Abstract

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Introduction

	The 2020 presidential election in America has been hotly discussed throughout the campaign season as the country appears divided on many key issues such as climate change, gun control, handling of the coronavirus, immigration and more. While election polls ideally predict the outcome of the election, information can also be derived regarding how respondents feel about important issues. Data from the Democracy Fund and the UCLA Nationscape was used to produce a model to help understand what demographic factors of respondents predicted their voting. 
	
	
	Using binary logistical regression, key demographic factors such as age, race/ethnicity, income, gender and state showed significantly relation to election outcomes. In particular, voters for Joe Biden were more likely to be younger, female, with income less than a hundred thousand dollars per year and from blue states (states more likely to vote democrat). Older, white males, who made over a hundred thousand dollars per year, were more likely to vote for republican candidate Donald Trump.  Using this model, a simulation was run on data provided by the American Census Survey for 2018. If everyone in the survey were to vote, it would appear as if Joe Biden is the winner (??? Not sure because we haven’t run the simulation but hopeful thinking)


```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

## Data
## Nationscape Data



The Nationscape Data Set is the result of a partnership between the Democracy Fund Voter Study Group and two Political Scientists at UCLA (Chris Tausanovitch and Lynn Vavreck). 
The Nationscape survey runs from July 2019 to December 2020, interviewing 6250 people per week (for a total of 500,000). The samples are produced weekly by a programmatic market research platform called Lucid.  

The American population of voting age (18+) is the population of the survey. The sampling frame is not given because Lucid runs an online exchange for respondents but claims that it is representative of the America public. Since the survey is done online, the frame is limited to all America’s that have access to the internet, are reachable online and own a device that is compatible with the software.
The individual samples of 6250 respondents are sent directly from Lucid to the Nationscape survey software. The samples are not simple random samples and the phased used in this report was only available in English.
Of the 6250 survey invitations sent, only about 75% of those surveys are included in the data as 12% decline immediately. Around 5% of the respondents are omitted because they stop participating during the survey and 8% are removed for speeding through the survey or straight line selecting answers. 

Nationscape data is meant to survey the population over time to see how people’s opinions change with events and campaign trails. The strength of the survey is not only the amount of people surveyed by the number of issues touched upon in the survey. This allows researchers to determine what the most important issues are and what tradeoffs voters are willing to make. 

Lucid works hard to ensure the integrity of their data. A question is asked during the survey to ensure participants are paying attention. Additionally, their supply partners, which help form their samples, are evaluated by third party data specialists and the scores of such evaluations are available to the public on their website. 

Another strength of the data is that it is weighted to mimic targets set out by the 2017 American Community Survey of the U.S. Census Bureau to be representative of the American population. The data is also checked for representativeness in a process used by Pew Research center. To do so, a number of questions are asked which are found on reliable, large scale, government surveys. Estimates from Nationscape surveys are then compared with government surveys, and the difference was in line with that produced by Pew Research. 

When mining for important variables, there were many categories where the question was not asked of all participants. While this is necessary to avoid too many people quitting the survey, some questions had a concrete answer for only 25% of respondents (such as the query regarding Medicare). Another weakness of the survey is that it is only available online and in English, which may deter those who are not comfortable with technology or English. 




```{r Prepare_data, echo = FALSE}
reduced_data <-survey_data
data <- survey_data

#Amalgamate ethnicities to match census 
Asian<-filter(data, race_ethnicity %in% c("Asian (Japanese)", "Asian (Japanese)", "Asian (Other)","Asian (Chinese)", "Asian (Korean)", "Asian (Filipino)", "Asian (Vietnamese)"))
Asian$race_ethnicity <- "Asian"
White<-filter(data, race_ethnicity %in% c("White"))
Black_AA<-filter(data, race_ethnicity %in% c("Black, or African American"))
Pacific_Islander <-filter(data, race_ethnicity %in% c("Pacific Islander (Samoan)", "Pacific Islander (Native Hawaiian)", "Pacific Islander (Other)","Pacific Islander (Guamanian)"))
Pacific_Islander$race_ethnicity <- "Pacific Islander"

Indigenous<-filter(data, race_ethnicity %in% c("American Indian or Alaska Native"))
Indigenous$race_ethnicity <- "Indigenous"
Other<-filter(data, race_ethnicity %in% c("Some other race"))
South_Asian<-filter(data, race_ethnicity %in% c("Asian (Asian Indian)"))
South_Asian$race_ethnicity <- "South Asian"
data2 <-rbind(Asian, White, Black_AA, Pacific_Islander, Indigenous, South_Asian, Other)
ethnicity <-table(data2$vote_2020, data2$race_ethnicity)
```
```{r race_association, echo = FALSE}
#Create a plot of how ethnicities tend to vote
barplot(ethnicity, cex.names = 0.5, beside=TRUE, main="Respondents Voting Habits By Ethnicity", xlab= "Ethnicity", legend.text = c("Donald Trump", "Joe Biden"), col = c("red", "blue"))
```
```{r genderplot, echo=FALSE}
#Make graph comparing voting habits of male and female voteds
gen_vote<-table(reduced_data$gender, reduced_data$vote_2020)
col = c("red","blue")
barplot(gen_vote, beside = TRUE, legend.text = TRUE, col = col, border = "white", main="How Respondents Plan to Vote in 2020 By Gender", ylab="Number of respondents", xlab="Options for 2020 American Election", cex.names = 0.7)
```

```{r ageplot, echo=FALSE}
gen_vote<-table(data$vote_2020, data$age)
barplot(gen_vote, beside = TRUE, legend.text = c("Donald Trump", "Joe Biden"), col = col, border = "white", main="How Respondents Plan to Vote in 2020 By Age Group", ylab="Number of respondents", xlab="Age Groups in Years", cex.names = 0.7)
```

```{r votecompare}
#Filter Data for Donald Trump Voters in 2016
vote_compareD <-filter(data, vote_2016=="Donald Trump")
vote_compareD <-table(vote_compareD$vote_2020)

#Filter Data for Hillary Clinton Voters in 2016
vote_compareHi <-filter(data, vote_2016=="Hillary Clinton")
vote_compareH <-table(vote_compareHi$vote_2020)

par(mfrow = c(1:2))
barplot(vote_compareD, col = "red", cex.names = 0.7, xlab="Voted for Trump in 2016", legend.text = c("Donald Trump", "Joe Biden"))
barplot(vote_compareH, col="blue", cex.names = 0.7, xlab="Voted for Clinton in 2016", legend.text = c("Donald Trump", "Joe Biden"))
```
```{r partyassoc, echo=FALSE}
vote_D <-filter(reduced_data, vote_2020=="0")
ideo <-table(vote_D$ideo5)
pie(ideo, main="Political Party Association of Respondents Voting for Donald Trump")
vote_J <-filter(reduced_data, vote_2020=="1")
ideoJ <-table(vote_J$ideo5)

pie(ideo, main="Political Party Association of Respondents Voting for Donald Trump")
pie(ideoJ, main="Political Party Association of Respondents Voting for Joe Biden")

```
```{r income, echo=FALSE}
vote_D <-filter(reduced_data, vote_2020=="0")
vote_J <-filter(reduced_data, vote_2020=="1")
income <-rbind(table(vote_J$household_income), table(vote_D$household_income))
par(las=2)
barplot(income, beside = TRUE, cex.names = 0.50, legend.text = c("Joe Biden", "Donald Trump"), col = c("blue", "red"), main = "Voting Tendencies of Respondents by Income Brackets", ylab="Number of Respondents")

```

```{r, echo=FALSE}
states <-rbind(table(vote_J$state), table(vote_D$state))
par(las=2)
barplot(states, beside = TRUE, cex.names = 0.50, legend.text = c("Joe Biden", "Donald Trump"), col = c("blue", "red"), main = "Voting Tendencies of Respondents by State Brackets", ylab="Number of Respondents")

```

```{r ElectoralVotes, echo=FALSE}
#creates table of states, number of electoral votes for that state, votes for biden and votes for trump
Electoral_votes_by_state <- matrix(c(3,9,6,11,55,9,7,3,3,29,16,4,6,4,20,11,
                                     6,8,8,11,10,4,16,10,10,6,3,15,3,5,4,14,
                                     5,6,29,18,7,7,20,4,9,3,11,38,6,13,3,12,10,5,3),
                                   ncol=1, byrow=TRUE)
rownames(Electoral_votes_by_state) <- c("AK","AL","AR","AZ","CA","CO","CT","DC","DE",
                                        "FL","GA","HI","IA","ID","IL","IN","KS","KY",
                                        "LA","MA","MD","ME","MI","MN","MO","MS","MT",
                                        "NC","ND","NE","NH","NJ","NM","NV","NY","OH",
                                        "OK","OR","PA","RI","SC","SD","TN","TX","UT",
                                        "VA","VT","WA","WI","WV","WY")
colnames(Electoral_votes_by_state) <- "Number of Votes"

votes_for_biden_states <- states[1,]
votes_for_trump_states <- states[2,]

Electoral_votes_by_state <- tibble(Electoral_votes_by_state)
Electoral_votes_by_state <- Electoral_votes_by_state %>% 
  mutate(States = c("AK","AL","AR","AZ","CA","CO","CT","DC","DE",
                                        "FL","GA","HI","IA","ID","IL","IN","KS","KY",
                                        "LA","MA","MD","ME","MI","MN","MO","MS","MT",
                                        "NC","ND","NE","NH","NJ","NM","NV","NY","OH",
                                        "OK","OR","PA","RI","SC","SD","TN","TX","UT",
                                        "VA","VT","WA","WI","WV","WY"), 
         "Number of Votes" = matrix(c(3,9,6,11,55,9,7,3,3,29,16,4,6,4,20,11,
                                     6,8,8,11,10,4,16,10,10,6,3,15,3,5,4,14,
                                     5,6,29,18,7,7,20,4,9,3,11,38,6,13,3,12,10,5,3),
                                   ncol=1, byrow=TRUE),
         "Votes for Biden" = votes_for_biden_states,
         "Votes for Trump" = votes_for_trump_states)


Electoral_votes_by_state <- Electoral_votes_by_state %>% 
  select(States, `Number of Votes`, `Votes for Biden`, `Votes for Trump`)

votes <- Electoral_votes_by_state %>% 
  select(`Number of Votes`, `Votes for Biden`,`Votes for Trump`)

```

```{r WinElectoralVotes, echo=FALSE}
#This chunk of code goes through the Electoral_votes_by_state data and sees who wins that state's electoral votes

x <- 1
Electoral_votes_Biden = 0
Electoral_votes_Trump = 0 

while (x<52) {
  ifelse(votes[x,2] > votes[x,3],
         Electoral_votes_Biden <- Electoral_votes_Biden + votes[x,1],
         Electoral_votes_Trump <- Electoral_votes_Trump + votes[x,1])
  x = x+1
}

tibble("Number of Electoral Votes for Biden" = 
         Electoral_votes_Biden$`Number of Votes`,
       "Number of Electoral Votes for Trump" = 
         Electoral_votes_Trump$`Number of Votes`)


#Who ever gets 270 or more electoral votes win
```


```{r CensusAnalysis, echo=FALSE}
census_data %>% 
  ggplot(aes(x=state)) +
  geom_bar(fill='red', color='black')+
  theme(axis.text.x=element_text(angle=90),panel.background = element_rect(fill = "lightblue", colour = "lightblue", size = 0.5, linetype = "solid")) +
  labs(x="States",
       y="Number of Respondents",
       title="Population in Each State")


census_data %>% 
  ggplot(aes(x=gender)) +
  geom_bar(fill='red', color='black')+
  theme(panel.background = element_rect(fill = "lightblue", colour = "lightblue", size = 0.5, linetype = "solid")) +
  labs(x="Gender",
       y="Number of Respondents",
       title="Gender Proportion in Census data")


census_data %>% 
  ggplot(aes(x=age)) +
  geom_bar(fill='red', color='black')+
  theme(panel.background = element_rect(fill = "lightblue", colour = "lightblue", size = 0.5, linetype = "solid")) +
  labs(x="Age range",
       y="Number of Respondents",
       title="Age range in the US")


pie(table(census_data$race_ethnicity), main = "Ethnicity")

census_data %>% 
  ggplot(aes(x=hispanic)) +
  geom_bar(fill='red', color='black')+
  theme(panel.background = element_rect(fill = "lightblue", colour = "lightblue", size = 0.5, linetype = "solid")) +
  labs(x="Hispanic",
       y="Number of Respondents",
       title="Hispanic Proportion in Census data")

pie(table(census_data$employment), main = "Employment Status")

pie(table(census_data$household_income), main = "Household income")
```

## Model

## Results

## Discussion

## References
